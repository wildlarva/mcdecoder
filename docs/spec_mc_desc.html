

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MC description specification &mdash; mcdecoder  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/override.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Template variable specification" href="spec_template_var.html" />
    <link rel="prev" title="Command line options" href="spec_commandline_options.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> mcdecoder
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">README</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_templates.html">User templates</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="specifications.html">Specifications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="spec_commandline_options.html">Command line options</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">MC description specification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-specification">Basic specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-specifications">Additional specifications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#split-a-description-into-multiple-files">Split a description into multiple files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#schema-specification">Schema specification</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spec_template_var.html">Template variable specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec_mcdecoder_model.html">MC decoder model specification</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mcdecoder</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="specifications.html">Specifications</a> &raquo;</li>
        
      <li>MC description specification</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/spec_mc_desc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mc-description-specification">
<h1>MC description specification<a class="headerlink" href="#mc-description-specification" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basic-specification">
<h2>Basic specification<a class="headerlink" href="#basic-specification" title="Permalink to this headline">¶</a></h2>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specification of machine code description file</span>
<span class="c1">#</span>
<span class="c1"># Machine code description file needs to be a YAML format.</span>

<span class="c1"># matchine: Describes a machine</span>
<span class="nt">machine</span><span class="p">:</span>
  <span class="nt">extras</span><span class="p">:</span> <span class="c1"># [optional] Container of user-defined data for the machine</span>
    <span class="c1"># Any structure can be defined here</span>
    <span class="nt">arch_type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">arm</span>

<span class="c1"># instructions: Describes instructions</span>
<span class="c1">#</span>
<span class="c1"># Each list element represents an instruction.</span>
<span class="nt">instructions</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">add_1</span> <span class="c1"># Name of the instruction</span>

    <span class="c1"># format: Encoding format of the instruction</span>
    <span class="c1">#</span>
    <span class="c1"># Instruction fields are separated by bar symbol(|).</span>
    <span class="c1"># Expression: &lt;field_bits&gt;:&lt;field_name&gt;[&lt;field_bit_ranges&gt;]|...</span>
    <span class="c1">#</span>
    <span class="c1"># where</span>
    <span class="c1">#   &lt;field_bits&gt;: Encoding format of an instruction field</span>
    <span class="c1">#     It takes an array of 0, 1 or x.</span>
    <span class="c1">#     &#39;0&#39; or &#39;1&#39; represents a fixed bit of the instruction field. &#39;x&#39; represents any bit.</span>
    <span class="c1">#</span>
    <span class="c1">#   &lt;field_name&gt;: [optional] Name of the instruction field</span>
    <span class="c1">#     NOTE: One field name can be used multiple times in one instruction.</span>
    <span class="c1">#           This constructs subfields of a field split into several bit ranges.</span>
    <span class="c1">#</span>
    <span class="c1">#   &lt;field_bit_ranges&gt;: [optional] Field bit ranges of an instruction field</span>
    <span class="c1">#     Each bit range expresses a subfield of the field.</span>
    <span class="c1">#     Subfields are separated by comma symbol(,).</span>
    <span class="c1">#     Expression: &lt;subfield_start&gt;:&lt;subfield_end&gt;,...</span>
    <span class="c1">#</span>
    <span class="c1">#   &lt;subfield_start&gt;: Subfield start bit position in the instruction field</span>
    <span class="c1">#     NOTE: This is a start bit position in a field, not in an instruction.</span>
    <span class="c1">#</span>
    <span class="c1">#   &lt;subfield_end&gt;: [optional] Subfield end bit position in the instruction field</span>
    <span class="c1">#     NOTE: This is an end bit position in a field, not in an instruction.</span>
    <span class="nt">format</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">xxxx:cond|00|1|0100|x:S|xxxx:Rn|xxxx:Rd|xxxx xxxx xxxx:imm12</span>

    <span class="c1"># match_condition: [optional] Bit condition when the instruction applys</span>
    <span class="c1">#</span>
    <span class="c1"># The following condition types are supported.</span>
    <span class="c1"># - Equality: The equality between a field value and a given value.</span>
    <span class="c1">#     Expression: &lt;field&gt; &lt;operator&gt; &lt;value&gt;</span>
    <span class="c1"># - In a set: A field value is in a given value set.</span>
    <span class="c1">#     Expression: &lt;field&gt; in &lt;values&gt;</span>
    <span class="c1"># - In a range: A field value is in a given value range(inclusive).</span>
    <span class="c1">#     Expression: &lt;field&gt; in_range &lt;value_start&gt;-&lt;value_end&gt;</span>
    <span class="c1">#</span>
    <span class="c1"># These conditions can be combined with a logical operator &#39;and&#39; or &#39;or&#39;.</span>
    <span class="c1"># You can also use &#39;(&#39; and &#39;)&#39; for readability.</span>
    <span class="c1">#</span>
    <span class="c1"># where</span>
    <span class="c1">#   &lt;field&gt;: A field name to be tested</span>
    <span class="c1">#</span>
    <span class="c1">#   &lt;operator&gt;: An equality operator to test</span>
    <span class="c1">#     It can be ==, !=, &lt;, &lt;=, &gt; or &gt;=.</span>
    <span class="c1">#</span>
    <span class="c1">#   &lt;values&gt;: A value set to test with</span>
    <span class="c1">#     Expression: [&lt;value&gt;,...]</span>
    <span class="c1">#     It takes multiple values with the separator &#39;,&#39;(comma symbol).</span>
    <span class="c1">#</span>
    <span class="c1">#   &lt;value&gt;: A value to test the equality to</span>
    <span class="c1">#     Base 2, 10 or 16 integer values like 15, 0b1111, 0xf, etc.</span>
    <span class="c1">#</span>
    <span class="c1">#   &lt;value_start&gt;: The start of a value range(inclusive)</span>
    <span class="c1">#     Base 2, 10 or 16 integer values like 15, 0b1111, 0xf, etc.</span>
    <span class="c1">#</span>
    <span class="c1">#   &lt;value_end&gt;: The end of a value range(inclusive)</span>
    <span class="c1">#     Base 2, 10 or 16 integer values like 15, 0b1111, 0xf, etc.</span>
    <span class="nt">match_condition</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">(cond in_range 0-14 and S == 1) or cond == 15</span>

    <span class="c1"># unmatch_condition: [optional] Bit condition when the instruction does not apply</span>
    <span class="c1">#</span>
    <span class="c1"># The expression is the same as that of match_condition.</span>
    <span class="c1"># unmatch_condition is mutually exclusive with match_condition.</span>
    <span class="nt">unmatch_condition</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cond == 15</span>

    <span class="nt">extras</span><span class="p">:</span> <span class="c1"># [optional] Container of user-defined data for the instruction</span>
      <span class="c1"># Any structure can be defined here</span>
      <span class="nt">clocks</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
    
    <span class="c1"># field_extras: [optional] Container of user-defined data for each field</span>
    <span class="c1"># </span>
    <span class="c1"># Each mapping key represents a field defining user-defined data and its value holds user-defined data for the field</span>
    <span class="nt">field_extras</span><span class="p">:</span>
      <span class="c1"># Any structure can be defined in a mapping value</span>
      <span class="nt">Rn</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">type</span><span class="p">:</span> <span class="nv">register</span><span class="p p-Indicator">}</span>
      <span class="nt">Rd</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">type</span><span class="p">:</span> <span class="nv">register</span><span class="p p-Indicator">}</span>
      <span class="nt">imm12</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">type</span><span class="p">:</span> <span class="nv">immediate</span><span class="p p-Indicator">}</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">push_1</span>
    <span class="nt">format</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">xxxx:cond|1001 00|1|0|1101|xxxx xxxx xxxx xxxx:register_list</span>
    <span class="nt">match_condition</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cond != 15</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">c_addi_1</span>
    <span class="nt">format</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">000:funct3|x:imm[5]|xxxx x:dest|xxx xx:imm[4:0]|01:op</span>

  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">c_sd_1</span>
    <span class="nt">format</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">111:funct3|x xxxx x:offset[5:3,8:6]|xxx xx:src|10:op</span>

<span class="nt">decoder</span><span class="p">:</span> <span class="c1"># [optional] Decoder information that isn&#39;t related to a machine, an instruction and a field</span>
  <span class="nt">namespace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ns</span> <span class="c1"># [optional] Namespace for the symbols of a generated decoder</span>

<span class="nt">extras</span><span class="p">:</span> <span class="c1"># [optional] Container of user-defined data that isn&#39;t related to a machine, an instruction and a field</span>
    <span class="c1"># Any structure can be defined here</span>
    <span class="nt">compiler</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">gcc</span>
</pre></div>
</div>
</div>
<div class="section" id="additional-specifications">
<h2>Additional specifications<a class="headerlink" href="#additional-specifications" title="Permalink to this headline">¶</a></h2>
<div class="section" id="split-a-description-into-multiple-files">
<h3>Split a description into multiple files<a class="headerlink" href="#split-a-description-into-multiple-files" title="Permalink to this headline">¶</a></h3>
<p>You can split a description into multiple files by using <code class="code docutils literal notranslate"><span class="pre">!include</span></code> tag.
You can use it anywhere in a description and
the contents of specified files will be inserted into the place
where the tag is.
If multiple files are specified, the contents will be combined.
The behavior depends on the types of the contents of files included:</p>
<ul class="simple">
<li><p>Sequence: Produce one sequence consisting of the elements of all sequences.</p></li>
<li><p>Mapping: Produce one mapping consisting of the elements of all mappings.</p></li>
<li><p>Scalar: Produce one sequence consisting of scalars.</p></li>
<li><p>Mixture: Prompt an error.</p></li>
</ul>
<p>Expression: <code class="code docutils literal notranslate"><span class="pre">!include</span> <span class="pre">&lt;path-included&gt;</span></code></p>
<p>where</p>
<dl class="simple">
<dt>&lt;path-included&gt;</dt><dd><p>A path to files included.
You can use the wildcard character <code class="code docutils literal notranslate"><span class="pre">*</span></code> (asterisk symbol)
to specify multiple files.</p>
</dd>
</dl>
<div class="section" id="example">
<h4>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h4>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">arm.yaml</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">machine</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
<span class="nt">instructions</span><span class="p">:</span> <span class="kt">!include</span> <span class="l l-Scalar l-Scalar-Plain">instructions/*_instructions.yaml</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">instructions/add_instructions.yaml</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">add_1</span>
  <span class="nt">format</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">xxxx:cond|00|1|0100|x:S|xxxx:Rn|xxxx:Rd|xxxx xxxx xxxx:imm12</span>
  <span class="nt">unmatch_condition</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cond == 15</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">instructions/push_instructions.yaml</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">push_1</span>
  <span class="nt">format</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">xxxx:cond|1001 00|1|0|1101|xxxx xxxx xxxx xxxx:register_list</span>
  <span class="nt">match_condition</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cond in_range 0-14</span>
</pre></div>
</div>
</div>
<p>You can see this <a class="reference download external" download="" href="https://github.com/wildlarva/mcdecoder/blob/master/examples/include"><code class="xref download docutils literal notranslate"><span class="pre">example</span> <span class="pre">in</span> <span class="pre">github</span></code></a>.</p>
</div>
</div>
</div>
<div class="section" id="schema-specification">
<h2>Schema specification<a class="headerlink" href="#schema-specification" title="Permalink to this headline">¶</a></h2>
<p>The schema is defined with JSON Schema and explained with the terms of it.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>type</p></td>
<td colspan="4"><p><em>object</em></p></td>
</tr>
<tr class="row-even"><td colspan="5"><p>properties</p></td>
</tr>
<tr class="row-odd"><td rowspan="4"><ul class="simple">
<li><p><strong>machine</strong></p></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="3"><p><em>object</em></p></td>
</tr>
<tr class="row-even"><td colspan="4"><p>properties</p></td>
</tr>
<tr class="row-odd"><td colspan="4"><ul class="simple">
<li><p>extras</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>additionalProperties</p></td>
<td colspan="3"><p>False</p></td>
</tr>
<tr class="row-odd"><td rowspan="18"><ul class="simple">
<li><p><strong>instructions</strong></p></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="3"><p><em>array</em></p></td>
</tr>
<tr class="row-even"><td colspan="4"><p>items</p></td>
</tr>
<tr class="row-odd"><td rowspan="16"><ul class="simple">
<li></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="2"><p><em>object</em></p></td>
</tr>
<tr class="row-even"><td colspan="3"><p>properties</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><ul class="simple">
<li><p><strong>name</strong></p></li>
</ul>
</td>
<td><p>type</p></td>
<td><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td><p>pattern</p></td>
<td><p>^[A-Za-z]w*$</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><ul class="simple">
<li><p><strong>format</strong></p></li>
</ul>
</td>
<td><p>type</p></td>
<td><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td><p>pattern</p></td>
<td><p>^[ws[]:,|]*$</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><ul class="simple">
<li><p>match_condition</p></li>
</ul>
</td>
<td><p>type</p></td>
<td><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td><p>pattern</p></td>
<td><p>^[ws-[],!=&gt;&lt;()]*$</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><ul class="simple">
<li><p>unmatch_condition</p></li>
</ul>
</td>
<td><p>type</p></td>
<td><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td><p>pattern</p></td>
<td><p>^[ws-[],!=&gt;&lt;()]*$</p></td>
</tr>
<tr class="row-odd"><td colspan="3"><ul class="simple">
<li><p>extras</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td rowspan="4"><ul class="simple">
<li><p>field_extras</p></li>
</ul>
</td>
<td><p>type</p></td>
<td><p><em>object</em></p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>patternProperties</p></td>
</tr>
<tr class="row-even"><td colspan="2"><ul class="simple">
<li><p>^[A-Za-z]w*$</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>additionalProperties</p></td>
<td><p>False</p></td>
</tr>
<tr class="row-even"><td><p>additionalProperties</p></td>
<td colspan="2"><p>False</p></td>
</tr>
<tr class="row-odd"><td rowspan="5"><ul class="simple">
<li><p>decoder</p></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="3"><p><em>object</em></p></td>
</tr>
<tr class="row-even"><td colspan="4"><p>properties</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><ul class="simple">
<li><p>namespace</p></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="2"><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td><p>pattern</p></td>
<td colspan="2"><p>^[A-Za-z]w*$</p></td>
</tr>
<tr class="row-odd"><td><p>additionalProperties</p></td>
<td colspan="3"><p>False</p></td>
</tr>
<tr class="row-even"><td colspan="5"><ul class="simple">
<li><p>extras</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>additionalProperties</p></td>
<td colspan="4"><p>False</p></td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="spec_template_var.html" class="btn btn-neutral float-right" title="Template variable specification" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="spec_commandline_options.html" class="btn btn-neutral float-left" title="Command line options" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, wildlarva

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>